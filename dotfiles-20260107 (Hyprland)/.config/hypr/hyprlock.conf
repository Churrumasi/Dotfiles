# ~/.config/hypr/hyprlock.conf
# Tema: Nord
# Fuente: JetBrainsMono Nerd Font

# ===== FONDO =====
background {
    monitor =
    path = screenshot
    blur_passes = 3
    blur_size = 8
    brightness = 0.85
    contrast = 1.15
}

# ===== MENSAJE DINÁMICO DE BIENVENIDA =====
label {
    monitor =
    text = cmd[once] bash -c 'h=$(date +%H); if [ $h -lt 6 ]; then g="Buenas noches"; elif [ $h -lt 12 ]; then g="Buenos días"; elif [ $h -lt 20 ]; then g="Buenas tardes"; else g="Buenas noches"; fi; printf "%s, %s!" "$g" "$(whoami)"'
    font_size = 28
    font_family = JetBrainsMono Nerd Font
    position = 0, 110
    halign = center
    valign = center
    color = rgb(216,222,233)   # nord4
    shadow_passes = 2
    shadow_size = 6
}

# ===== HORA =====
label {
    monitor =
    text = cmd[update:1000] date +"%H:%M"
    font_size = 64
    font_family = JetBrainsMono Nerd Font
    position = 0, 190
    halign = center
    valign = center
    color = rgb(229,233,240)   # nord5
    shadow_passes = 2
    shadow_size = 8
}

# ===== USUARIO =====
label {
    monitor =
    text = cmd[once] whoami
    font_size = 16
    font_family = JetBrainsMono Nerd Font
    position = 0, 60
    halign = center
    valign = center
    color = rgb(216,222,233)   # nord4
}

# ===== INPUT / CAMPO DE CONTRASEÑA =====
input-field {
    monitor =
    size = 360, 60
    position = 0, -40
    halign = center
    valign = center

    rounding = 12
    outline_thickness = 2

    inner_color = rgba(46,52,64,230)     # nord0
    outer_color = rgba(129,161,193,220)  # nord9

    font_color = rgb(236,239,244)        # nord6

    dots_center = true
    dots_rounding = -1
    dots_size = 0.55
    dots_spacing = 0.35

    fade_on_empty = false
    placeholder_text = <i>contraseña</i>
}

# ===== CAPS LOCK (estado dinámico) =====
label {
    monitor =
    text = cmd[update:500] bash -c 'if [ -e /sys/class/leds ]; then val=$(sed -n "s/^[[:space:]]*\\([01]\\).*$/\\1/p" /sys/class/leds/*::capslock/brightness 2>/dev/null | head -n1); if [ "$val" = "1" ]; then printf "CAPS LOCK: ON"; else printf "Caps Lock: off"; fi; else printf "Caps Lock: ?"; fi'
    font_size = 14
    font_family = JetBrainsMono Nerd Font
    position = -180, -46
    halign = left
    valign = center

    color = cmd[update:500] bash -c 'if [ -e /sys/class/leds/*::capslock/brightness ]; then val=$(cat /sys/class/leds/*::capslock/brightness 2>/dev/null | head -n1); if [ "$val" = "1" ]; then echo "rgb(191,97,106)"; else echo "rgb(136,192,208)"; fi; else echo "rgb(136,192,208)"; fi'

    shadow_passes = 1
    shadow_size = 4
}

# ===== BATERÍA / RED =====
label {
    monitor =
    text = cmd[update:60000] bash -c '
    if [ -d /sys/class/power_supply ]; then
      for d in /sys/class/power_supply/*; do
        [ -f "$d/capacity" ] || continue
        printf "Batería: %s%% (%s)\n" "$(cat "$d/capacity")" "$(cat "$d/status" 2>/dev/null)"
        break
      done
    else
      printf "Batería: N/A\n"
    fi
    if command -v nmcli >/dev/null 2>&1; then
      ssid=$(nmcli -t -f ACTIVE,SSID dev wifi | awk -F: '\''$1=="yes"{print $2; exit}'\'')
      [ -n "$ssid" ] && printf "Red: %s\n" "$ssid" || printf "Red: desconectado\n"
    else
      printf "Red: N/A\n"
    fi
    '
    font_size = 14
    font_family = JetBrainsMono Nerd Font
    position = 0, -106
    halign = center
    valign = center
    color = rgb(136,192,208)   # nord8
    shadow_passes = 1
    shadow_size = 5
}

# ===== ZONA INFERIOR =====
label {
    monitor =
    text = cmd[update:60000] date +"%A, %d %B %Y"
    font_size = 16
    font_family = JetBrainsMono Nerd Font
    position = 0, -170
    halign = center
    valign = center
    color = rgb(216,222,233)   # nord4
}

label {
    monitor =
    text = cmd[update:60000] bash -c "printf 'Sistema: %s | Uptime: %s' \"$(hostname)\" \"$(uptime -p | sed 's/up //')\""
    font_size = 14
    font_family = JetBrainsMono Nerd Font
    position = 0, -200
    halign = center
    valign = center
    color = rgb(129,161,193)   # nord9
}

label {
    monitor =
    text = "Presiona Enter para desbloquear · Esc para cancelar"
    font_size = 13
    font_family = JetBrainsMono Nerd Font
    position = 0, -230
    halign = center
    valign = center
    color = rgb(76,86,106)     # nord3
}

# ===== MENSAJE DE ERROR =====
label {
    monitor =
    text = cmd[once] echo ""
    font_size = 16
    font_family = JetBrainsMono Nerd Font
    position = 0, -150
    halign = center
    valign = center
    color = rgb(208,135,112)   # nord12
}
