# ~/.config/hypr/hyprlock.conf
# Paleta de referencia:
# #242b36  #8D99A8  #A6BAC6  #D5BCC3  #C9D2DD  #E9D6DE  #D1D9E2  #c8cacc  #6a7481

# ===== FONDO =====
background {
    monitor =
    path = screenshot
    blur_passes = 3
    blur_size = 8
    brightness = 0.85
    contrast = 1.15
}

# ===== MENSAJE DINÁMICO DE BIENVENIDA (evaluado al bloquear) =====
label {
    monitor =
    text = cmd[once] bash -c 'h=$(date +%H); if [ $h -lt 6 ]; then g="Buenas noches"; elif [ $h -lt 12 ]; then g="Buenos días"; elif [ $h -lt 20 ]; then g="Buenas tardes"; else g="Buenas noches"; fi; printf "%s, %s!" "$g" "$(whoami)"'
    font_size = 28
    font_family = JetBrainsMono Nerd Font
    position = 0, 110
    halign = center
    valign = center
    color = rgb(201,210,221)   # #C9D2DD
    shadow_passes = 2
    shadow_size = 6
}

# ===== HORA (actualiza cada segundo) =====
label {
    monitor =
    text = cmd[update:1000] date +"%H:%M"
    font_size = 64
    font_family = JetBrainsMono Nerd Font
    position = 0, 190
    halign = center
    valign = center
    color = rgb(233,214,222)   # #E9D6DE
    shadow_passes = 2
    shadow_size = 8
}

# ===== USUARIO (estático) =====
label {
    monitor =
    text = cmd[once] whoami
    font_size = 16
    font_family = JetBrainsMono Nerd Font
    position = 0, 60
    halign = center
    valign = center
    color = rgb(201,210,221)   # #C9D2DD
}

# ===== INPUT / CAMPO DE CONTRASEÑA =====
input-field {
    monitor =
    size = 360, 60
    position = 0, -40
    halign = center
    valign = center

    rounding = 12
    outline_thickness = 2

    # Fondo del campo: gris oscuro (alpha fuerte para contraste)
    inner_color = rgba(36, 43, 54, 230)   # #242b36 con alpha fuerte

    # Borde claro para delimitar
    outer_color = rgba(201,210,221, 220)  # #C9D2DD

    # Texto del placeholder / feedback (muy legible)
    font_color = rgb(233,233,233)         # casi blanco

    # DOTS (asteriscos visuales) MUY CLAROS
    dots_center = true
    dots_rounding = -1
    dots_size = 0.55
    dots_spacing = 0.35

    fade_on_empty = false
    placeholder_text = <i>contraseña</i>
}

# ===== CAPS LOCK (estado, color dinámico) =====
label {
    monitor =
    # Muestra texto de estado (ON/OFF) y se actualiza cada 500 ms.
    text = cmd[update:500] bash -c 'if [ -e /sys/class/leds ]; then val=$(sed -n "s/^[[:space:]]*\\([01]\\).*$/\\1/p" /sys/class/leds/*::capslock/brightness 2>/dev/null | head -n1); if [ "$val" = "1" ]; then printf "CAPS LOCK: ON"; else printf "Caps Lock: off"; fi; else printf "Caps Lock: ?"; fi'
    font_size = 14
    font_family = JetBrainsMono Nerd Font
    position = -180, -46
    halign = left
    valign = center

    # color cambia dinámicamente (rojo cuando ON, gris cuando OFF)
    color = cmd[update:500] bash -c 'if [ -e /sys/class/leds/*::capslock/brightness ]; then val=$(cat /sys/class/leds/*::capslock/brightness 2>/dev/null | head -n1); if [ "$val" = "1" ]; then echo "rgb(220,80,80)"; else echo "rgb(150,150,150)"; fi; else echo "rgb(150,150,150)"; fi'

    shadow_passes = 1
    shadow_size = 4
}

# ===== DETALLES CENTRALES (BATERÍA / RED) =====
label {
    monitor =
    text = cmd[update:60000] bash -c '
    # BATERÍA (primera encontrada con capacity)
    if [ -d /sys/class/power_supply ]; then
      found=0
      for d in /sys/class/power_supply/*; do
        [ -f "$d/capacity" ] || continue
        cap=$(cat "$d/capacity")
        st=$( [ -f "$d/status" ] && cat "$d/status" || echo "N/A" )
        printf "Batería: %s%% (%s)\n" "$cap" "$st"
        found=1
        break
      done
      [ $found -eq 0 ] && printf "Batería: N/A\n"
    else
      printf "Batería: N/A\n"
    fi
    # RED (nmcli si existe)
    if command -v nmcli >/dev/null 2>&1; then
      ssid=$(nmcli -t -f ACTIVE,SSID dev wifi | awk -F: '\''$1=="yes"{print $2; exit}'\'' )
      if [ -n "$ssid" ]; then printf "Red: %s\n" "$ssid"; else printf "Red: desconectado\n"; fi
    else
      printf "Red: N/A\n"
    fi
    '
    font_size = 14
    font_family = JetBrainsMono Nerd Font
    position = 0, -106
    halign = center
    valign = center
    color = rgb(168,180,198)  # #A6BAC6
    shadow_passes = 1
    shadow_size = 5
}

# ===== ZONA INFERIOR (fecha / sistema / uptime / tips) =====

# Fecha completa
label {
    monitor =
    text = cmd[update:60000] date +"%A, %d %B %Y"
    font_size = 16
    font_family = JetBrainsMono Nerd Font
    position = 0, -170
    halign = center
    valign = center
    color = rgb(168,180,198)   # #A6BAC6
}

# Sistema + Uptime
label {
    monitor =
    text = cmd[update:60000] bash -c "printf 'Sistema: %s | Uptime: %s' \"$(hostname)\" \"$(uptime -p | sed 's/up //')\""
    font_size = 14
    font_family = JetBrainsMono Nerd Font
    position = 0, -200
    halign = center
    valign = center
    color = rgb(141,153,168)   # #8D99A8
}

# Tip / instrucción
label {
    monitor =
    text = "Presiona Enter para desbloquear · Esc para cancelar"
    font_size = 13
    font_family = JetBrainsMono Nerd Font
    position = 0, -230
    halign = center
    valign = center
    color = rgb(106,116,129)   # #6a7481
}

# ===== Mensaje de error / feedback (vacío por defecto) =====
label {
    monitor =
    text = cmd[once] echo ""
    font_size = 16
    font_family = JetBrainsMono Nerd Font
    position = 0, -150
    halign = center
    valign = center
    color = rgb(213,188,195)  # #D5BCC3
}
